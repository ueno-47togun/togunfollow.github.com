function calculatePaging(e,t){t=t||factory.pageSize;var o="&$top="+t;return e>1&&(o+="&$skip="+(e-1)*t),o}function orderBy(e){return"&$orderby="+e}function _formatFileSize(e){var t=0===e?0:Math.round(Math.log(e)/Math.log(1024)||0),o=(e/Math.pow(1024,t)).toFixed(2);return o+" "+(0===t?"bytes":"KMGTPEZY"[t-1]+"B")}function _inKB(e){return e/1024}function _inMB(e){return _inKB(e)/1024}function _inGB(e){return _inMB(e)/1024}function findCurrentIP(){var e=window.location.hash.split("#");return e[e.length-1].split("?")[0].split("/")[0]}function getIP(e){if(e){for(var t={},o=0;o<e.length;o++){var r={name:e[o].Name,plural:e[o].Plural,id:e[o].ID,icon:e[o].Icon};t[makeWebSafe(r.name)]=r,t[makeWebSafe(r.plural)]=r}this.IP=t}return this.IP[findCurrentIP()]}function getAllIP(){return this.allIP}function getAllIntellectNav(){return this.allIntellectNavs}function setAllIP(e){this.allIP=e,this.allIntellectNavs=JSON.parse(JSON.stringify(e)),this.allIntellectNavs.push({Mode:"a",Name:"Video",Plural:"Videos",Icon:"film"}),this.allIntellectNavs.push({Mode:"a",Name:"Audio",Plural:"Audios",Icon:"music"}),this.allIntellectNavs.push({Mode:"a",Name:"Image",Plural:"Images",Icon:"picture-o"}),this.allIntellectNavs.push({Mode:"a",Name:"Document",Plural:"Documents",Icon:"file-o"}),this.allIntellectNavs.unshift({Mode:"c",Name:"Company",Plural:"Companies",Icon:"building"})}function makeWebSafe(e){return null==e?"":e.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function isEmail(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}angular.module("underscore",[]).factory("_",function(){return window._}),angular.module("app",["ionic","angularMoment","app.api","app.controllers","app.directives","app.filters","app.services","app.factories","app.config","underscore","ngMap","ngResource","ngSanitize","ngCordova","slugifier","ionic.contrib.ui.tinderCards","youtube-embed","blueimp.fileupload","LocalStorageModule","md5","angular-cache"]).run(["$ionicPlatform","PushNotificationsService","$rootScope","$ionicConfig","$timeout","Api",function(e,t,o,r,n,i){i.isLoggedIn(function(e){o.me=e}),e.on("deviceready",function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault(),t.register()}),o.$on("$stateChangeStart",function(e,t,o,i,a){t.name.indexOf("auth.login")>-1&&n(function(){r.views.transition("android"),r.views.swipeBackEnabled(!1)},0)}),o.$on("$stateChangeSuccess",function(e,t,o,n,i){t.name.indexOf(home)>-1&&(r.views.transition("platform"),ionic.Platform.isIOS()&&r.views.swipeBackEnabled(!0))}),e.on("resume",function(){t.register()})}]).config(["$stateProvider","$urlRouterProvider","$ionicConfigProvider","$httpProvider","fileUploadProvider",function(e,t,o,r,n){angular.extend(n.defaults,{previewMaxWidth:320,previewMaxHeight:180,previewMinWidth:320,disableImageResize:/Android(?!.*Chrome)|Opera/.test(window.navigator.userAgent),maxFileSize:200*Math.pow(1024,3),maxChunkSize:2*Math.pow(1024,2),acceptFileTypes:/(^Video\/(x-ms-wmv|mp4|avi|x-flv)+$)|(\.|\/)(264|787|3gp2|3gpp|3p2|aaf|aep|aetx|ajp|amv|amx|arf|avb|axm|bdmv|bin|bmk|camrec|clpi|cmmp|cmmtpl|cmproj|cmrec|cst|cvc|d2v|d3v|dat|dce|dck|dir|dmb|dmsd|dmsd3d|dmss|dpa|dpg|dv|dv-avi|dvr|dvx|dxr|dzt|evo|eye|f4p|fbz|fcp|flc|flh|fli|gfp|gts|hkm|ifo|imovieproject|ismc|ivf|ivr|izz|izzy|jts|jtv|m1pg|m21|m21|m2t|m2ts|m2v|mgv|mj2|mjp|mnv|mp21|mp21|mpgindex|mpl|mpls|mpv|mqv|msdvd|mswmm|mtv|mvb|mvd|mve|mvp|mvp|mvy|ncor|nsv|nuv|nvc|ogm|ogx|pgi|photoshow|piv|pmf|ppj|prel|pro|prtl|pxv|qtl|qtz|rdb|rec|rmd|rmp|rms|roq|rsx|rum|rv|sbk|scc|screenflow|seq|sfvidcap|smi|smk|ssm|stl|svi|swt|tda3mt|tivo|tod|tp|tp0|tpd|tpr|tsp|tvs|vc1|vcpf|vcv|vdo|vdr|vep|vfz|vgz|viewlet|vlab|vp6|vp7|vpj|vsp|wcp|wmd|wmmp|wmx|wp3|wpl|wvx|xej|xel|xesc|xfl|xlmv|zm1|zm2|zm3|zmv|aepx|ale|avp|avs|bdm|bik|bsf|camproj|cpi|divx|dmsm|dream|dvdmedia|dvr-ms|dzm|dzp|edl|f4v|fbr|fcproject|hdmov|imovieproj|ism|ismv|m2p|m4v|mkv|mod|moi|mpeg|mts|mxf|ogv|pds|prproj|psh|r3d|rcproject|rmvb|scm|smil|sqz|srt|stx|swi|tix|trp|ts|veg|vf|vro|webm|wlmp|wtv|xvid|yuv|anim|bix|dsy|gl|grasp|gvi|ivs|lsf|m15|m4e|m75|mmv|mob|mpeg4|mpf|mpg2|mpv2|msh|rmd|rts|scm|sec|tdx|viv|vivo|vp3|3gpp2|3mm|60d|aet|avd|avs|bnp|box|bs4|byu|dav|ddat|dif|dlx|dmsm3d|dnc|dv4|fbr|flx|gvp|h264|irf|iva|k3g|lrec|lsx|m1v|m2a|m4u|meta|mjpg|modd|moff|moov|movie|mp2v|mp4v|mpe|mpsub|mvc|mys|osp|par|playlist|pns|pssd|pva|pvr|qt|qtch|qtm|rp|rts|sbt|scn|sfd|sml|smv|spl|str|vcr|vem|vft|vfw|vid|video|vs4|vse|w32|wm|wot|3g2|3gp|asf|asx|avi|flv|mov|mp4|mpg|rm|swf|vob|wmv|gif|svg|jpe?g|png|tif|bmp|xls|xlsx|ppt|pptx|txt|rtf|pdf|doc|docx|html|htm|mp3|mp4|wav|3gp|aac|m4a|m4p|ogg|wma|vox)$/i,maxNumberOfFiles:20,maxRetries:100,retryTimeout:500}),e.state("auth",{url:"/auth",templateUrl:"views/auth/auth.html","abstract":!0,controller:"AuthCtrl"}).state("auth.login",{url:"/login",controller:"LoginCtrl",templateUrl:"views/auth/login.html"}).state("auth.logout",{url:"/logout",controller:"SignoutCtrl",templateUrl:"views/auth/login.html"}).state("auth.signup",{url:"/signup",templateUrl:"views/auth/signup.html",controller:"SignupCtrl"}).state("auth.forgot-password",{url:"/forgot-password",templateUrl:"views/auth/forgot-password.html",controller:"ForgotPasswordCtrl"}).state("auth.reset-password",{url:"/reset-password",templateUrl:"views/auth/reset-password.html",controller:"ResetPasswordCtrl"}).state("app",{url:"/app","abstract":!0,templateUrl:"views/app/side-menu.html"}).state("app.password",{url:"/change-password",controller:"ChangePasswordCtrl",views:{menuContent:{templateUrl:"views/auth/password.html"}}}).state("app.home",{url:"/home","abstract":!0,views:{menuContent:{templateUrl:"views/app/home.html"}}}).state("app.home.upload",{url:"/upload",views:{"upload-tab":{templateUrl:"views/app/home/upload.html",controller:"UploadCtrl"}}}).state("app.home.playlist",{url:"/playlist","abstract":!0,views:{"playlist-tab":{templateUrl:"views/app/home/playlist.html"}}}).state("app.home.playlist.index",{url:"/index",views:{"playlist-tab":{templateUrl:"views/app/home/playlist.index.html",controller:"PlaylistCtrl"}}}).state("app.home.playlist.items",{url:"/items/:id",views:{"playlist-tab":{templateUrl:"views/app/home/playlist.items.html",controller:"PlaylistItemsCtrl"}}}).state("app.home.saving",{url:"/saving",views:{"saving-tab":{templateUrl:"views/app/home/saving.html",controller:"SavingCtrl"}}}).state("app.shop",{url:"/shop",views:{menuContent:{templateUrl:"views/ext/shop.html",controller:"TermsCtrl"}}}).state("app.events",{url:"/events",views:{menuContent:{templateUrl:"views/ext/events.html",controller:"TermsCtrl"}}}).state("app.about",{url:"/about",views:{menuContent:{templateUrl:"views/ext/about.html",controller:"TermsCtrl"}}}).state("auth.terms",{url:"/terms",controller:"TermsCtrl",templateUrl:"views/auth/terms.html"}).state("app.home.playlist.watch",{url:"/watch/:playlist/:id",views:{"playlist-tab":{templateUrl:"views/app/home/watch.html",controller:"WatchCtrl"}}}).state("app.home.send",{url:"/send",views:{"send-tab":{templateUrl:"views/app/home/send.html",controller:"SendCtrl"}}}).state("app.settings",{url:"/settings",views:{menuContent:{templateUrl:"views/app/settings.html",controller:"SettingsCtrl"}}}).state("app.profileEdit",{url:"/profile/edit",views:{menuContent:{templateUrl:"views/app/profile.edit.html",controller:"EditProfileCtrl"}}}).state("app.profile",{url:"/profile",views:{menuContent:{templateUrl:"views/app/profile.html"}}}),t.otherwise("/auth/login")}]),function(){"use strict";var e={picture:/(^Image\/(gif|jpe?g|png|svg)+$)|(\.|\/)(gif|jpe?g|png|svg)$/i,video:/(^Video\/(x-ms-wmv|mp4|avi|x-flv)+$)|(\.|\/)(264|787|3gp2|3gpp|3p2|aaf|aep|aetx|ajp|amv|amx|arf|avb|axm|bdmv|bin|bmk|camrec|clpi|cmmp|cmmtpl|cmproj|cmrec|cst|cvc|d2v|d3v|dat|dce|dck|dir|dmb|dmsd|dmsd3d|dmss|dpa|dpg|dv|dv-avi|dvr|dvx|dxr|dzt|evo|eye|f4p|fbz|fcp|flc|flh|fli|gfp|gts|hkm|ifo|imovieproject|ismc|ivf|ivr|izz|izzy|jts|jtv|m1pg|m21|m21|m2t|m2ts|m2v|mgv|mj2|mjp|mnv|mp21|mp21|mpgindex|mpl|mpls|mpv|mqv|msdvd|mswmm|mtv|mvb|mvd|mve|mvp|mvp|mvy|ncor|nsv|nuv|nvc|ogm|ogx|pgi|photoshow|piv|pmf|ppj|prel|pro|prtl|pxv|qtl|qtz|rdb|rec|rmd|rmp|rms|roq|rsx|rum|rv|sbk|scc|screenflow|seq|sfvidcap|smi|smk|ssm|stl|svi|swt|tda3mt|tivo|tod|tp|tp0|tpd|tpr|tsp|tvs|vc1|vcpf|vcv|vdo|vdr|vep|vfz|vgz|viewlet|vlab|vp6|vp7|vpj|vsp|wcp|wmd|wmmp|wmx|wp3|wpl|wvx|xej|xel|xesc|xfl|xlmv|zm1|zm2|zm3|zmv|aepx|ale|avp|avs|bdm|bik|bsf|camproj|cpi|divx|dmsm|dream|dvdmedia|dvr-ms|dzm|dzp|edl|f4v|fbr|fcproject|hdmov|imovieproj|ism|ismv|m2p|m4v|mkv|mod|moi|mpeg|mts|mxf|ogv|pds|prproj|psh|r3d|rcproject|rmvb|scm|smil|sqz|srt|stx|swi|tix|trp|ts|veg|vf|vro|webm|wlmp|wtv|xvid|yuv|anim|bix|dsy|gl|grasp|gvi|ivs|lsf|m15|m4e|m75|mmv|mob|mpeg4|mpf|mpg2|mpv2|msh|rmd|rts|scm|sec|tdx|viv|vivo|vp3|3gpp2|3mm|60d|aet|avd|avs|bnp|box|bs4|byu|dav|ddat|dif|dlx|dmsm3d|dnc|dv4|fbr|flx|gvp|h264|irf|iva|k3g|lrec|lsx|m1v|m2a|m4u|meta|mjpg|modd|moff|moov|movie|mp2v|mp4v|mpe|mpsub|mvc|mys|osp|par|playlist|pns|pssd|pva|pvr|qt|qtch|qtm|rp|rts|sbt|scn|sfd|sml|smv|spl|str|vcr|vem|vft|vfw|vid|video|vs4|vse|w32|wm|wot|3g2|3gp|asf|asx|avi|flv|mov|mp4|mpg|rm|swf|vob|wmv)$/i,any:/(^Video\/(x-ms-wmv|mp4|avi|x-flv)+$)|(\.|\/)(264|787|3gp2|3gpp|3p2|aaf|aep|aetx|ajp|amv|amx|arf|avb|axm|bdmv|bin|bmk|camrec|clpi|cmmp|cmmtpl|cmproj|cmrec|cst|cvc|d2v|d3v|dat|dce|dck|dir|dmb|dmsd|dmsd3d|dmss|dpa|dpg|dv|dv-avi|dvr|dvx|dxr|dzt|evo|eye|f4p|fbz|fcp|flc|flh|fli|gfp|gts|hkm|ifo|imovieproject|ismc|ivf|ivr|izz|izzy|jts|jtv|m1pg|m21|m21|m2t|m2ts|m2v|mgv|mj2|mjp|mnv|mp21|mp21|mpgindex|mpl|mpls|mpv|mqv|msdvd|mswmm|mtv|mvb|mvd|mve|mvp|mvp|mvy|ncor|nsv|nuv|nvc|ogm|ogx|pgi|photoshow|piv|pmf|ppj|prel|pro|prtl|pxv|qtl|qtz|rdb|rec|rmd|rmp|rms|roq|rsx|rum|rv|sbk|scc|screenflow|seq|sfvidcap|smi|smk|ssm|stl|svi|swt|tda3mt|tivo|tod|tp|tp0|tpd|tpr|tsp|tvs|vc1|vcpf|vcv|vdo|vdr|vep|vfz|vgz|viewlet|vlab|vp6|vp7|vpj|vsp|wcp|wmd|wmmp|wmx|wp3|wpl|wvx|xej|xel|xesc|xfl|xlmv|zm1|zm2|zm3|zmv|aepx|ale|avp|avs|bdm|bik|bsf|camproj|cpi|divx|dmsm|dream|dvdmedia|dvr-ms|dzm|dzp|edl|f4v|fbr|fcproject|hdmov|imovieproj|ism|ismv|m2p|m4v|mkv|mod|moi|mpeg|mts|mxf|ogv|pds|prproj|psh|r3d|rcproject|rmvb|scm|smil|sqz|srt|stx|swi|tix|trp|ts|veg|vf|vro|webm|wlmp|wtv|xvid|yuv|anim|bix|dsy|gl|grasp|gvi|ivs|lsf|m15|m4e|m75|mmv|mob|mpeg4|mpf|mpg2|mpv2|msh|rmd|rts|scm|sec|tdx|viv|vivo|vp3|3gpp2|3mm|60d|aet|avd|avs|bnp|box|bs4|byu|dav|ddat|dif|dlx|dmsm3d|dnc|dv4|fbr|flx|gvp|h264|irf|iva|k3g|lrec|lsx|m1v|m2a|m4u|meta|mjpg|modd|moff|moov|movie|mp2v|mp4v|mpe|mpsub|mvc|mys|osp|par|playlist|pns|pssd|pva|pvr|qt|qtch|qtm|rp|rts|sbt|scn|sfd|sml|smv|spl|str|vcr|vem|vft|vfw|vid|video|vs4|vse|w32|wm|wot|3g2|3gp|asf|asx|avi|flv|mov|mp4|mpg|rm|swf|vob|wmv|gif|jpe?g|png|tif|bmp|xls|xlsx|ppt|pptx|txt|rtf|pdf|psd|doc|docx|html|htm|mp3|mp4|wav|3gp|aac|m4a|m4p|ogg|wma|vox)$/i},t={connectionRetry:"Server Connection Failed, retrying",maxAttempts:"Unable to upload",uploading:"Processing uploads",uploaderNotAvailable:"Uploader not available, please try again",hasMaster:"Checking to see if master already exists",resumeUploading:"Existing master found, resuming upload",fileInProgress:"File already in progress to publishing",profileStart:"Fetching encode profiles",profileSuccess:"Fetching encode profiles",profileError:"Cannot find upload profiles, please reload and start again",queCreated:"Adding encode to queue",queFailed:"Unable to add files to queue, please reload and start again, if problem persist, please contact tech support",estimateUploadTime:"Estimating encode time",createRecord:"Creating database entries",createRecordRetry:"Retrying to create database entries",createRecordFailed:"Unable to create database entry, please contact technical support",masterPrepare:"Preparing master for upload",masterUploadProgress:"Uploading master",masterUploadRetry:"Upload failed, retrying",masterUploadFailed:"Upload failed, process aborted, please check your internet connection and try again",uploadComplete:"Upload complete",storageReachError:"Encoder storage not available, retrying",encoderMessageUnavailable:"Encoder message not available, encode terminated",loadingFileForHive:"Loading  file to encoder",loadingFailForHive:"Unable to load file to encoding network",sentToHive:"File sent to encoder",sendRetryToHive:"Encoder failed, retrying",sendFailedHive:"Encoder failed, please contact technical support",thumbStarted:"Thumbnails being created",thumbProgress:"X thumbnails created",thumbRetry:"Thumbnails not created, retrying",thumbFailed:"Thumbnails not created, please create manually",encodingStarted:"Encoding started (est time and %)",encodingCompleted:"Encode completed",viewAsset:"View"},o=angular.module("app");o.directive("ngUploadForm",["$rootScope","fileUpload",function(){return{restrict:"E",templateUrl:function(e,t){return t.templateUrl||"/views/upload/file.html"},scope:{progress:"@",acceptFileTypes:"@",dropzone:"@",storage:"@",container:"@",containerkey:"@",titlekey:"@",master:"@",user:"@",resumeUpload:"@",icon:"@",readonly:"@",url:"@",size:"@",fileList:"=",autoUpload:"@",sizeLimit:"@",ngModel:"=",title:"@",name:"@",quick:"@",serverMode:"@",categories:"=",onUploaded:"&",onProgramme:"&",onMetaUpdate:"&"},controller:["$rootScope","$scope","$element","fileUpload","$http",function(o,r,n,i,a){function s(t,o,r){return t||o<10*Math.pow(1024,2)&&!e.video.test(r)}function l(e){if(e.vmodel&&e.vmodel.fileInfo)return e.vmodel.fileInfo.partial=!0,e.vmodel.fileInfo;var t={name:e.name,size:e.size,user:r.user,storage:r.storage,container:r.container||0,master:e.master||r.master||0,que:e.que};return r.quick&&(t.quick=!0),r.containerkey&&(t.containerkey=r.containerkey),t}function c(e,o,n){var i=o.files[0],s=l(i);return e>10?(i.error=t.maxAttempts,void r.$apply()):(i.validating=!0,a.defaults.headers.common={"Content-Type":"application/json; charset=utf-8","X-VidZapper-Server":r.serverMode},a.defaults.headers.post={},a.defaults.headers.put={},a.defaults.headers.patch={},a.post(r.url+"broken",s).then(function(a,l){var p=a.data;clearInterval(o.bogusWatcher),o.uploadedBytes=parseInt(p.uploadedBytes)||0,p.error?(i.cause="validation","ECONNRESET"===p.error.code||"EPIPE"===p.error.code?(i.error=t.uploaderNotAvailable,o.sizeChecker=setTimeout(c,1e3*e,++e,o)):i.error=p.error.code||p.error):(i.error&&delete i.error,s.que=p.que,s.master=p.master,i.que=p.que,i.master=p.master,i.valid=!0,i.validating=!1,o.uploadedBytes===s.size?(i.error=t.fileInProgress,i.progress=100):(o.uploadedBytes>0?i.message=t.resumeUploading:i.message=t.uploading,i.programme=p.programme||0,r.ngModel.programme=i.programme,r.onProgramme({programme:i.programme}),i.title=p.title,u[i.name]=i,o.scope.option("formData",s),n()))},function(r){clearInterval(o.bogusWatcher),i.error=t.connectionRetry+" "+e+" of 10",i.cause="validation",o.sizeChecker=setTimeout(c,1e3*e,++e,o,n)}))}"undefined"==typeof r.ngModel&&(r.ngModel={url:"",email:"",title:r.title});var u={};r.$on("fileuploadprocessalways",function(e,t){var o=t.files[0];return u[o.name]=o,o.error?(o.cause="validation",!1):void(s(r.quick,o.size,o.type)&&t.submit())}),r.$on("fileuploadadd",function(e,t){var o=t.files[0];t.scope.option("url",r.url),s(r.quick,o.size,o.type)?(o.valid=!0,o.validating=!1,t.scope.option("formData",l(o))):c(0,t,function(){t.submit()})}),r.$on("fileuploaddone",function(e,t){var o=t._response.result.files[0];r.ngModel.url=o.url,r.result=o,r.title=o.originalname,r.error=o.error,o.valid=!0,o.validating=!1,o.uploaded=!0;var n=u[o.originalname];n&&(o.preview=n.preview),r.current=o,r.onUploaded({file:o}),r.$apply(),t.scope.$apply(),i.addFieldData(r.name,o)}),r.$on("fileuploadprogress",function(e,t){var o=t.files[0],n=t.progress(),i=100*n.loaded/n.total;t.scope.prg=i,o.progress=i,o.uploaded=100==i,o.uploading=100>i,r.current=o,t.scope.$apply()}),r.$on("fileuploadchunkdone",function(e,t){if(t.files&&t.files.length){for(var o in t.files){var n=t.files[o];if(n)try{var i=JSON.parse(t.result);n.remaining=i.files[0].eta}catch(e){}}r.current=t.files[0]}t.scope.$apply()}),r.$on("fileuploadprogressall",function(e,t){t.progress=Math.floor(t.loaded/t.total*100),t.remainingTime=8*(t.total-t.loaded)/t.bitrate,r.overall=t,r.$apply()}),r.$on("fileuploadfail",function(e,t){r.current=t.files[0],t.scope.$apply()});var p={url:r.url,dropZone:n,autoUpload:!1,acceptFileTypes:e[r.acceptFileTypes||"picture"],maxNumberOfFiles:20,limitConcurrentUploads:4,minFileSize:1,maxRetries:100,retryTimeout:500,messages:{maxNumberOfFiles:"Maximum number of files exceeded, allowed 20 at once.",acceptFileTypes:"File type not allowed, only video / audio / document types allowed.",maxFileSize:"File is too large, max upload limit is 200GB",minFileSize:"File is too small, file should be atleast 1 Byte"}};r.serverMode&&(p.headers={"X-VidZapper-Server":r.serverMode}),r.sizeLimit&&(p.maxFileSize=r.sizeLimit),r.queue||(r.queue=[]);var d=function(e){var t=[];angular.forEach(e,function(e,o){var n=JSON.parse(angular.toJson(u[e.originalname])),i=JSON.parse(angular.toJson(e)),a=angular.extend(n,i);a.size=e.fileLength||a.size,a.thumbnailUrl=e.url,a.deleteUrl=e.url,a.deleteType="DELETE",a.preview=u[e.originalname].preview,a.url&&"/"!==a.url.charAt(0)&&(a.url="/"+a.url),a.deleteUrl&&"/"!==a.deleteUrl.charAt(0)&&(a.deleteUrl="/"+a.deleteUrl),a.thumbnailUrl&&"/"!==a.thumbnailUrl.charAt(0)&&(a.thumbnailUrl="/"+a.thumbnailUrl),-1==t.indexOf(a.name)&&t.push(a.name),a.ready&&(a.message="Completed"),r.queue[t.indexOf(a.name)]=a,r.current=a})};i.registerField(r.name),i.setOption(p),r.options=p,r.filequeue=i.fieldData[r.name],r.$watchCollection("filequeue",function(e){d(e)})}]}}])}(),angular.module("app.api",[]).factory("config",["$http","$rootScope",function(e,t){return e.get("/settings",{cache:!0}).then(function(e){return t.config=e.data,e.data})}]).service("Api",["$http","$q","CacheFactory","config","$state",function(e,t,o,r,n){function i(e,t){return function(o,r){o&&o.ExceptionMessage&&o.ExceptionMessage.indexOf("A second operation started on this context before a previous asynchronous operation completed")>-1&&t?setTimeout(t,200):o&&"ENOTFOUND"!=o.code?404==r?e.resolve():(console.error("ERR01!",r),e.reject(o,r)):(e.reject("Unable to connect to server"),console.error("Unable to connect to server"))}}function a(t){t&&(e.defaults.headers.common={},e.defaults.headers.post={},e.defaults.headers.put={},e.defaults.headers.patch={});var o=u();return e.defaults.headers.common["Access-Control-Allow-Origin"]="*",e.defaults.headers.common["Content-Type"]="application/json; charset=utf-8",o&&o.access_token&&(e.defaults.headers.common.Authorization="Bearer "+o.access_token),e}function s(e,o,r,s,l,c){function u(){var t=m.get(e);return t?void p.resolve(t):void a().get(e).success(function(t){"string"==typeof t&&-1!==t.indexOf("<title>Log in : VidZapper</title>")&&(n.go("auth.login"),console.log("Unauthenticated")),"Unauthorized"===t?(console.error("Access Denied",e),p.resolve()):(m.put(e.replace("&nocache=true",""),t),p.resolve(t))}).error(i(p,u))}"object"==typeof o&&(r=o.size,s=o.counts,l=o.order,c=o.filter,o=o.page);var p=t.defer();r=r||-1,o=o||1;var d="";return-1!=r&&(d+="&$top="+r,o>1&&(d+="&$skip="+r*(o-1)),s&&(d+="&$inlinecount=allpages")),l&&(d+="&$orderby="+l),c&&(d+="&$filter="+c),""!=d&&(e+=(-1==e.indexOf("?")?"?":"")+d),u(),p.promise}function l(e,o,r){var n=t.defer();return a(r).post(e,o).success(function(t){"Unauthorized"===t?(console.error("Access Denied",e),n.reject("Unauthorized")):n.resolve(t)}).error(i(n)),n.promise}function c(e,o,r){var n=t.defer();return a(r).put(e,o).success(function(t){"Unauthorized"===t?(console.error("Access Denied",e),n.reject("Unauthorized")):n.resolve(t)}).error(i(n)),n.promise}function u(e){return e&&f.put(d,e,{maxAge:1e3*e.expires_in}),f.get(d)}function p(o,r){e.defaults.headers.common={},e.defaults.headers.post={},e.defaults.headers.put={},e.defaults.headers.patch={};var n=t.defer();return e({method:"POST",url:o,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(e){var t=[];for(var o in e)t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t.join("&")},data:r}).success(function(e,t,o,r){return e.error?void n.reject(e.Message||e.error_description):void n.resolve(e)}).error(i(n)),n.promise}var d="token",m=o("vzmc",{maxAge:9e5,cacheFlushInterval:36e5,deleteOnExpire:"aggressive",storageMode:"localStorage"}),f=o("vzms",{storageMode:"localStorage"}),v="/api/",g=m.get("hack")||(new Date).getTime(),h={config:function(){return r.$$state.value?r.$$state.value:{}},token:u,login:function(e,o,r){var n=t.defer(),i=this;return i.logout(),p(v+"token",{username:e,password:o,grant_type:r||"password"}).then(function(e){u(e),g=(new Date).getTime(),m.put("hack",g),i.me().then(n.resolve,n.reject)},n.reject),n.promise},externalLogin:function(e,o,r){var n=t.defer(),i=this;return p(v+"token",{provider:e,token:o,grant_type:r||"external_access_token"}).then(function(e){g=(new Date).getTime(),m.put("hack",g),u(e),i.me().then(n.resolve,n.reject)},n.reject),n.promise},getProfile:function(){return s(v+"account/me/profile?_="+g)},app:function(){return s(v+"app")},updateMeta:function(e){return l(v+"account/ugc/meta",e)},updateProfile:function(e){var o=t.defer();return l(v+"account/me/profile",e).then(function(e){m.put(v+"account/me/profile?_="+g,e),o.resolve(e)},o.reject)},register:function(e,t){return l(v+"account/register/mobile",{email:e,password:t},!0)},logout:function(){e.defaults.headers.common={},e.defaults.headers.post={},e.defaults.headers.put={},e.defaults.headers.patch={},f.removeAll(),m.removeAll()},playlists:function(){return s(v+"playlist/all/"+this.config().playlists.join(","))},likeVideo:function(e){return c(v+"social/like/"+e,{})},unlikeVideo:function(e){return c(v+"social/unlike/"+e,{})},watchLater:function(e){return l(v+"account/ugc/playlist",{ProgrammeId:e,Playlist:"Watch Later",IsPublic:!1})},removeWatchLater:function(e){return c(v+"account/ugc/playlist/remove",{ProgrammeId:e,Playlist:"Watch Later"})},starVideo:function(e,t){return c(v+"social/star/"+e,{stars:t})},videosByPlaylist:function(e,t){return s(v+"watch/pl/rox/"+e)},socialsByVideos:function(e){return c(v+"social/me",{id:e})},videoById:function(e,t){return s(v+"watch/ep/rox/"+t)},commentsByVideoId:function(e){return s(v+"account/comment/on/programme/"+e+"?$orderby=ID desc&$inlinecount=allpages")},postFacebook:function(e,t){return l(v+"account/facebook",{title:e.title,description:e.description,picture:e.image,link:t})},postTwitter:function(e,t){return l(v+"account/twitter",{title:e.title,url:t})},postGoogle:function(e,t){return l(v+"account/google",{title:e.title,description:e.description,picture:e.image,link:t})},commentOnVideo:function(e){return l(v+"account/comment/on/programme",e).then(function(t){return m.remove(v+"account/comment/on/programme/"+e.programmeId),s(v+"account/comment/on/programme/"+e.programmeId+"?$orderby=ID desc&nocache=true&$inlinecount=allpages")})},forgot:function(e,t){return l(v+"account/forgot",{username:e,branding:t})},resetPassword:function(e){return l(v+"account/forgot/confirm",e)},isLoggedIn:function(e){u()?this.me().then(e):e()},me:function(e){var o=t.defer(),r=this;return e&&(g=(new Date).getTime(),m.put("hack",g)),s(v+"util/me?_="+g).then(function(e){e&&"string"!=typeof e?(e.home=home,r.app().then(function(t){e.encoder=t.App.Encoder,o.resolve(e)})):o.reject("Unable to login")},function(e){o.reject(e&&e.Message||e)}),o.promise}};return h}]);var home="app.home.playlist.index";angular.module("app.controllers",[]).controller("AuthCtrl",["$scope","$ionicConfig",function(e,t){}]).controller("ChangePasswordCtrl",["$scope","$ionicConfig",function(e,t){}]).controller("SignoutCtrl",["$scope","$state","$rootScope","Api",function(e,t,o,r){r.logout(),t.go("auth.login")}]).controller("TermsCtrl",["$scope","$ionicConfig",function(e,t){}]).controller("AppCtrl",["$scope","$state","$rootScope","Api",function(e,t,o,r){r.isLoggedIn(function(e){e||t.go("auth.login")}),e.goToProfile=function(){t.go("app.profileEdit")}}]).controller("ExternalCtrl",function(e){}).controller("EditProfileCtrl",["$scope","$state","$rootScope","Api","resizer",function(e,t,o,r){e.selectLanguage=function(t){e.record.LanguageID=t},r.getProfile().then(function(t){t.Extra=t.Extra||{},t.Extra.banner=t.Extra.banner||"",t.Birthday=moment(t.Birthday)._d,e.record=t}),e.updatePicture=function(t){e.record.Picture=t.url},e.updateBanner=function(t){e.record.Extra.banner=t.url},e.saveProfile=function(t,n){var i=angular.copy(t);return e.error=null,t.FirstName||t.Surname?(e.saving=!0,void r.updateProfile(i).then(function(t){e.saving=!1,o.me=t})):void(e.error="First and Last name required")}}]).controller("UploadCtrl",["$scope","$state","Api",function(e,t,o){e.updateMeta=function(e){var t=angular.copy(e.meta);t.id=e.programme,e.saving=!0,o.updateMeta(t).then(function(){e.msg="Thanks for contributing. your video will be reviewed and available shortly!",e.saving=!1})}}]).controller("LoginCtrl",["$scope","$state","$rootScope","Api","authService",function(e,t,o,r,n){function i(t){e.error=t}r.isLoggedIn(function(e){e&&(o.me=e,t.go(home))}),e.authExternalProvider=function(t){var o=location.protocol+"//"+location.host+"/complete.html",n=r.config().serviceBase+"account/externallogin?provider="+t+"&response_type=token&client_id="+r.config().id+"&returnUrl="+o;window.$windowScope=e;window.open(n,"Authenticate Account","location=0,status=0,width=600,height=750")},e.authCompletedCB=function(a){e.$apply(function(){"false"==a.haslocalaccount?(n.logOut(),n.externalAuthData={provider:a.provider,userName:a.external_user_name,externalAccessToken:a.external_access_token},e.error="Account already exists with this email, you can login and connect "+a.provider.split(":")[0]+" account"):r.externalLogin(a.provider,a.external_access_token,"external_access_token").then(function(r){o.me=r,r?t.go(r.home):e.error="unable to login : "+JSON.strigify(r)},i)})},e.doLogIn=function(n){e.error="",r.login(n.email,n.password).then(function(e){o.me=e,t.go(home)},i)},e.user={}}]).controller("SignupCtrl",["$scope","$state","$rootScope","Api",function(e,t,o,r){function n(t){e.loading.login=!1,e.errors=t}function i(i){delete e.errors,e.loading.login=!0,r.login(i.email,i.password).then(function(r){e.loading.login=!1,o.me=r,t.go(home)},n)}e.user={},e.loading={login:!1},e.doSignup=function(e){r.register(e.email,e.password).then(function(t){t.Succeeded?i(e):n(t.Errors)},n)}}]).controller("ForgotPasswordCtrl",["$scope","$state","Api",function(e,t,o){e.doForgot=function(e,r){o.forgot(e,r).then(function(o){"Password Sent"==o.Title&&t.go("auth.reset-password",{params:{email:e}})})},e.user={}}]).controller("ResetPasswordCtrl",["$scope","$state","Api","$stateParams",function(e,t,o,r){console.log(r),e.user={userName:r.email,key:"",password:""},e.resetPassord=function(t){t.confirmPassword=t.password,o.resetPassword(t).then(function(t){t.Succeeded?e.result="Password Changed Successfully.":e.result=t.Errors.join(",")})}}]).controller("PlaylistCtrl",["$scope","$state","Api",function(e,t,o){function r(){o.playlists().then(function(t){e.records=t})}r()}]).controller("PlaylistItemsCtrl",["$scope","$state","$stateParams","Api",function(e,t,o,r){function n(t){e.loading=!0,e.playlistId=t,r.videosByPlaylist(t,i).then(function(t){e.records=t,e.loading=!1},function(t){e.error=t,e.loading=!1})}var i=1;e.records=[],e.loading=!1,n(o.id)}]).controller("WatchCtrl",["$scope","$state","$stateParams","Api","$sce","authService","$rootScope",function(e,t,o,r,n,i,a){function s(t){r.commentOnVideo(t).then(function(o){e.comments=o,t.message=""})}e.loading=!0;var l=parseInt(o.id),c=parseInt(o.playlist);e.comment={programmeId:l,message:""},e.trustSrc=function(e){return n.trustAsResourceUrl(e)},e.watchUrl="rich/video/"+l+"?autostart=true",e.toggleLike=function(e){e&&(e.social=e.social||{},1!=e.social.Like?(r.likeVideo(e.mediaid),e.social.Like=1):(r.unlikeVideo(e.mediaid),e.social.Like=-1))},e.toggleLater=function(e){e&&(e.social=e.social||{},1!=e.social.Later?(r.watchLater(e.mediaid),e.social.Later=1):(r.removeWatchLater(e.mediaid),e.social.Later=-1))},e.rateVideo=function(e,t){r.starVideo(e.mediaid,t),e.star=t},e.addComment=s,e.programmeCreated=function(e){s({programmeId:l,message:"",richContentId:"video/"+e})},e.receiveEncoding=function(t){e.encoding=t},e.toggleTab=function(t){e.tab=t},e.authExternalProvider=function(t){var o=location.protocol+"//"+location.host+"/complete.html",n=r.config().serviceBase+"connect/"+t+"?response_type=token&client_id="+r.config().id+"&auth_token="+r.token().access_token+"&returnUrl="+o;window.$windowScope=e;window.open(n,"Connect Account","location=0,status=0,width=600,height=750")},e.authCompletedCB=function(t){e.$apply(function(){console.log(t),"true"==t.connected?r.me(!0).then(function(e){a.me=e}):"Error"==t.message&&(e.error=t.values)})},e.postOnFacebook=function(t,o){e.fb=!0,r.postFacebook(t,o).then(function(t){e.fb=!1})},e.postOnTwitter=function(t,o){e.twt=!0,r.postTwitter(t,o).then(function(t){e.twt=!1})},e.postOnGoogle=function(t,o){e.gplus=!0,r.postGoogle(t,o).then(function(t){e.gplus=!1})},r.videoById(c,l).then(function(t){var o=t[0];r.socialsByVideos([l]).then(function(t){e.loading=!1,o.social=t&&t[0],e.video=o,e.tab="vidcomment",r.commentsByVideoId(l).then(function(t){e.comments=t})})})}]).controller("SendCtrl",["$scope",function(e){e.sendMail=function(){cordova.plugins.email.isAvailable(function(e){cordova.plugins.email.open({to:"envato@startapplabs.com",cc:"hello@startapplabs.com",subject:"Greetings",body:"How are you? Nice greetings from IonFullApp"})})}}]).controller("SettingsCtrl",["$scope","$ionicActionSheet","$state",function(e,t,o){e.airplaneMode=!0,e.wifi=!1,e.bluetooth=!0,e.personalHotspot=!0,e.checkOpt1=!0,e.checkOpt2=!0,e.checkOpt3=!1,e.radioChoice="B",e.showLogOutMenu=function(){t.show({destructiveText:"Logout",titleText:"Are you sure you want to logout? This app is awsome so I recommend you to stay.",cancelText:"Cancel",cancel:function(){},buttonClicked:function(e){return!0},destructiveButtonClicked:function(){o.go("auth.login")}})}}]),angular.module("app.directives",[]).directive("myTabs",function(){return{restrict:"E",transclude:!0,scope:{},controller:function(e){var t=e.tabs=[];e.select=function(o){angular.forEach(t,function(e){e.selected=!1}),o.selected=!0,e.$emit("my-tabs-changed",o)},this.addTab=function(o){0===t.length&&e.select(o),t.push(o)}},templateUrl:"views/common/my-tabs.html"}}).directive("backImg",["resizer",function(e){return{scope:"=",controller:["$scope","$element","$attrs",function(t,o,r){t.$watch(r.backImg,function(t){if(t){var r=o.find("a");r.css({"background-image":"url("+e(t,360)+")"})}})}]}}]).directive("myTab",function(){return{require:"^myTabs",restrict:"E",transclude:!0,scope:{title:"@"},link:function(e,t,o,r){r.addTab(e)},templateUrl:"views/common/my-tab.html"}}).directive("validPin",["$http",function(e){return{require:"ngModel",link:function(e,t,o,r){e.$watch(o.ngModel,function(e){"12345"==e?r.$setValidity("valid-pin",!0):r.$setValidity("valid-pin",!1)})}}}]).directive("showHideContainer",function(){return{scope:{},controller:["$scope","$element","$attrs",function(e,t,o){e.show=!1,e.toggleType=function(t){t.stopPropagation(),t.preventDefault(),e.show=!e.show,e.$broadcast("toggle-type",e.show)}}],templateUrl:"views/common/show-hide-password.html",restrict:"A",replace:!1,transclude:!0}}).directive("showHideInput",function(){return{scope:{},link:function(e,t,o){e.$on("toggle-type",function(e,o){var r=t[0];r.getAttribute("type");o||r.setAttribute("type","password"),o&&r.setAttribute("type","text")})},require:"^showHideContainer",restrict:"A",replace:!1,transclude:!1}}).directive("biggerText",["$ionicGesture",function(e){return{restrict:"A",link:function(t,o,r){e.on("touch",function(e){e.stopPropagation(),e.preventDefault();var t=document.querySelector(r.biggerText),o=document.querySelector(".menu-content"),n=window.getComputedStyle(t,null).getPropertyValue("font-size"),i=parseFloat(n),a=Math.min(i+2,24),s=a+"px";
o.classList.remove("post-size-"+n),o.classList.add("post-size-"+s)},o)}}}]).directive("smallerText",["$ionicGesture",function(e){return{restrict:"A",link:function(t,o,r){e.on("touch",function(e){e.stopPropagation(),e.preventDefault();var t=document.querySelector(r.smallerText),o=document.querySelector(".menu-content"),n=window.getComputedStyle(t,null).getPropertyValue("font-size"),i=parseFloat(n),a=Math.max(i-2,12),s=a+"px";o.classList.remove("post-size-"+n),o.classList.add("post-size-"+s)},o)}}}]).directive("dynamicAnchorFix",["$ionicGesture","$timeout","$cordovaInAppBrowser",function(e,t,o){return{scope:{},link:function(e,r,n){t(function(){var e=r.find("a");e.length>0&&angular.forEach(e,function(e){var t=angular.element(e);t.bind("click",function(e){e.preventDefault(),e.stopPropagation();var t=e.currentTarget.href,r={};o.open(t,"_blank",r).then(function(e){})["catch"](function(e){})})})},10)},restrict:"A",replace:!1,transclude:!1}}]).directive("multiBg",function(e){return{scope:{multiBg:"=",interval:"=",helperClass:"@"},controller:["$scope","$element","$attrs",function(t,o,r){t.loaded=!1;var n=this;this.animateBg=function(){t.$apply(function(){t.loaded=!0,o.css({"background-image":"url("+t.bg_img+")"})})},this.setBackground=function(e){t.bg_img=e},e.isUndefined(t.multiBg)||(e.isArray(t.multiBg)&&t.multiBg.length>1&&!e.isUndefined(t.interval)&&e.isNumber(t.interval)?n.setBackground(t.multiBg[0]):n.setBackground(t.multiBg[0]))}],templateUrl:"views/common/multi-bg.html",restrict:"A",replace:!0,transclude:!0}}).directive("bg",function(){return{restrict:"A",require:"^multiBg",scope:{ngSrc:"@"},link:function(e,t,o,r){t.on("load",function(){r.animateBg()})}}}).directive("preImg",function(){return{restrict:"E",transclude:!0,scope:{ratio:"@",helperClass:"@"},controller:["$scope","$element","$attrs",function(e,t,o){e.loaded=!1,this.hideSpinner=function(){e.$apply(function(){e.loaded=!0})}}],templateUrl:"views/common/pre-img.html"}}).directive("spinnerOnLoad",function(){return{restrict:"A",require:"^preImg",scope:{ngSrc:"@"},link:function(e,t,o,r){t.on("load",function(){r.hideSpinner()})}}});var _formatBitrate=function(e){return"number"!=typeof e?"":e>=1e9?(e/1e9).toFixed(2)+" Gbit/s":e>=1e6?(e/1e6).toFixed(2)+" Mbit/s":e>=1e3?(e/1e3).toFixed(2)+" kbit/s":e.toFixed(2)+" bit/s"},_formatTime=function(e){var t=new Date(1e3*e),o=Math.floor(e/86400);return o=o?o+"d ":"",o+("0"+t.getUTCHours()).slice(-2)+":"+("0"+t.getUTCMinutes()).slice(-2)+":"+("0"+t.getUTCSeconds()).slice(-2)},_formatPercentage=function(e){return(100*e).toFixed(2)+" %"},funcs={pageSize:10,calculatePaging:calculatePaging,orderBy:orderBy,ip:getIP,setAllIP:setAllIP,getAllIP:getAllIP,getAllIntellectNav:getAllIntellectNav,safe:makeWebSafe,format:{bit:_formatBitrate,time:_formatTime,cent:_formatPercentage,size:_formatFileSize,gb:_inGB},capitalize:function(e){return e.replace(/^./,function(e){return e.toUpperCase()})}};angular.module("app.filters",[]).filter("eta",function(){return function(e){var t="0:00:00";return e&&!isNaN(e)&&(t=funcs.format.time(e)),t}}).filter("rawHtml",function(e){return function(t){return e.trustAsHtml(t)}}).filter("filesize",function(){return function(e){return funcs.format.size(e)}}).filter("parseDate",function(){return function(e){return Date.parse(e)}}).filter("eta",function(){return function(e){var t="0:00:00";return e&&!isNaN(e)&&(t=funcs.format.time(e)),t}}).filter("encode",function(){return window.encodeURIComponent}).filter("time",function(){return function(e,t){var o=parseInt(e);isNaN(o)&&(o=0);var r=Math.floor(o/3600)<10?("00"+Math.floor(o/3600)).slice(-2):Math.floor(o/3600),n=("00"+Math.floor(o%3600/60)).slice(-2),i=("00"+o%3600%60).slice(-2),a=("00"!=r?r+":":"")+n+":"+i;if(t){var s=("000"+parseInt(1e3*(e-parseInt(e)))).slice(-3);a+="."+s}return a}}).filter("moment",function(){return function(e,t){return e?moment(e).format(t):""}}).filter("fromNow",function(){return function(e){return e&&-1==e.indexOf("+")&&-1==e.indexOf("Z")&&(e+="+00:00"),moment(e).utc().fromNow()}}).filter("viewer",function(){return function(e){return 800>e?e:8e5>e?(e/1e3).toFixed(2)+"k":8e8>e?(e/1e6).toFixed(2)+"M":(e/1e9).toFixed(2)+"B"}}).filter("resize",["resizer",function(e){return e}]).filter("gravtaar",["md5","resizer",function(e,t){function o(e){var t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)}return function(r,n,i,a){if(i=i||150,r){if(r.indexOf("youtube.com")>-1)return r;if(-1===r.indexOf("http://")&&(r="http://images.vidzapper.com/"+r),-1===r.indexOf("www.gravatar.com")&&-1===r.indexOf("notfound")&&-1===r.indexOf("placehold.it/")&&"http://images.vidzapper.com/"!==r)return t(r,i)}return o(n)?"//www.gravatar.com/avatar/"+e(n)+"?s="+i+"&d="+(a||"mm"):"notfound"!=a?"//www.gravatar.com/avatar/"+e(r||"")+"?s="+i+"&d="+(a||"mm"):null}}]),angular.module("app.services",[]).service("FeedList",["$rootScope","FeedLoader","$q",function(e,t,o){this.get=function(e){var r=o.defer();return t.fetch({q:e,num:20},{},function(e){r.resolve(e.responseData)}),r.promise}}]).service("PushNotificationsService",["$rootScope","$cordovaPush","NodePushServer","GCM_SENDER_ID",function(e,t,o,r){this.register=function(){var n={};ionic.Platform.isAndroid()&&(n={senderID:r},t.register(n).then(function(e){console.log("$cordovaPush.register Success"),console.log(e)},function(e){console.log("$cordovaPush.register Error"),console.log(e)}),e.$on("$cordovaPush:notificationReceived",function(e,t){switch(console.log(JSON.stringify([t])),t.event){case"registered":t.regid.length>0&&(console.log("registration ID = "+t.regid),o.storeDeviceToken("android",t.regid));break;case"message":"1"==t.foreground?console.log("Notification received when app was opened (foreground = true)"):"1"==t.coldstart?console.log("Notification received when app was closed (not even in background, foreground = false, coldstart = true)"):console.log("Notification received when app was in background (started but not focused, foreground = false, coldstart = false)"),console.log("message = "+t.message);break;case"error":console.log("GCM error = "+t.msg);break;default:console.log("An unknown GCM event has occurred")}})),ionic.Platform.isIOS()&&(n={badge:!0,sound:!0,alert:!0},t.register(n).then(function(e){console.log("result: "+e),o.storeDeviceToken("ios",e)},function(e){console.log("Registration error: "+e)}),e.$on("$cordovaPush:notificationReceived",function(e,t){console.log(t.alert,"Push Notification Received")}))}}]).service("BookMarkService",["_","$rootScope",function(e,t){this.bookmarkFeedPost=function(o){var r=e.isUndefined(window.localStorage.ionFullApp_feed_bookmarks)?[]:JSON.parse(window.localStorage.ionFullApp_feed_bookmarks),n=e.find(r,function(e){return e.link==o.link});n||r.push({link:o.link,title:o.title,date:o.publishedDate,excerpt:o.contentSnippet}),window.localStorage.ionFullApp_feed_bookmarks=JSON.stringify(r),t.$broadcast("new-bookmark")},this.bookmarkWordpressPost=function(o){var r=e.isUndefined(window.localStorage.ionFullApp_wordpress_bookmarks)?[]:JSON.parse(window.localStorage.ionFullApp_wordpress_bookmarks),n=e.find(r,function(e){return e.id==o.id});n||r.push({id:o.id,title:o.title,date:o.date,excerpt:o.excerpt}),window.localStorage.ionFullApp_wordpress_bookmarks=JSON.stringify(r),t.$broadcast("new-bookmark")},this.getBookmarks=function(){return{feeds:JSON.parse(window.localStorage.ionFullApp_feed_bookmarks||"[]"),wordpress:JSON.parse(window.localStorage.ionFullApp_wordpress_bookmarks||"[]")}}}]).service("PostService",["$rootScope","$http","$q","WORDPRESS_API_URL",function(e,t,o,r){this.getRecentPosts=function(e){var n=o.defer();return t.jsonp(r+"get_recent_posts/?page="+e+"&callback=JSON_CALLBACK").success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},this.getPost=function(e){var n=o.defer();return t.jsonp(r+"get_post/?post_id="+e+"&callback=JSON_CALLBACK").success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},this.shortenPosts=function(e){var t=500;return _.map(e,function(e){if(e.content.length>t){var o=e.content.substr(0,t);o=o.substr(0,Math.min(o.length,o.lastIndexOf("</p>"))),e.content=o}return e})},this.sharePost=function(e){window.plugins.socialsharing.share("Check this post here: ",null,null,e)}}]),angular.module("app.factories",[]).factory("FeedLoader",function(e){return e("http://ajax.googleapis.com/ajax/services/feed/load",{},{fetch:{method:"JSONP",params:{v:"1.0",callback:"JSON_CALLBACK"}}})}).factory("tokensManagerService",["$http",function(e){var t={},o=function(){return e.get("/api/refreshtokens").then(function(e){return e})},r=function(t){return e["delete"]("/api/refreshtokens/?tokenid="+t).then(function(e){return e})};return t.deleteRefreshTokens=r,t.getRefreshTokens=o,t}]).factory("authService",["$http","$q","localStorageService","Api",function(e,t,o,r){var n={},i={isAuth:!1,userName:"",useRefreshTokens:!1},a={provider:"",userName:"",externalAccessToken:""},s=function(t){return c(),e.post(r.config().serviceBase+"account/register",t).then(function(e){return e})},l=function(n){var a="grant_type=password&username="+n.userName+"&password="+n.password;n.useRefreshTokens&&(a=a+"&client_id="+r.config().id);var s=t.defer();return e.post(r.config().serviceBase+"token",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){n.useRefreshTokens?o.set("authorizationData",{token:e.access_token,userName:n.userName,refreshToken:e.refresh_token,useRefreshTokens:!0}):o.set("authorizationData",{token:e.access_token,userName:n.userName,refreshToken:"",useRefreshTokens:!1}),i.isAuth=!0,i.userName=n.userName,i.useRefreshTokens=n.useRefreshTokens,s.resolve(e)}).error(function(e,t){c(),s.reject(e)}),s.promise},c=function(){o.remove("authorizationData"),i.isAuth=!1,i.userName="",i.useRefreshTokens=!1},u=function(){var e=o.get("authorizationData");e&&(i.isAuth=!0,i.userName=e.userName,i.useRefreshTokens=e.useRefreshTokens)},p=function(){var n=t.defer(),i=o.get("authorizationData");if(i&&i.useRefreshTokens){var a="grant_type=refresh_token&refresh_token="+i.refreshToken+"&client_id="+r.config().id;o.remove("authorizationData"),e.post(r.config().serviceBase+"token",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(e){o.set("authorizationData",{token:e.access_token,userName:e.userName,refreshToken:e.refresh_token,useRefreshTokens:!0}),n.resolve(e)}).error(function(e,t){c(),n.reject(e)})}return n.promise},d=function(n){var a=t.defer();return e.get(r.config().serviceBase+"account/tokens",{params:{provider:n.provider,externalAccessToken:n.externalAccessToken}}).success(function(e){o.set("authorizationData",{token:e.access_token,userName:e.userName,refreshToken:"",useRefreshTokens:!1}),i.isAuth=!0,i.userName=e.userName,i.useRefreshTokens=!1,a.resolve(e)}).error(function(e,t){c(),a.reject(e)}),a.promise},m=function(n){var a=t.defer();return e.post(r.config().serviceBase+"account/registerexternal",n).success(function(e){o.set("authorizationData",{token:e.access_token,userName:e.userName,refreshToken:"",useRefreshTokens:!1}),i.isAuth=!0,i.userName=e.userName,i.useRefreshTokens=!1,a.resolve(e)}).error(function(e,t){c(),a.reject(e)}),a.promise};return n.saveRegistration=s,n.login=l,n.logOut=c,n.fillAuthData=u,n.authentication=i,n.refreshToken=p,n.obtainAccessToken=d,n.externalAuthData=a,n.registerExternal=m,n}]).factory("NodePushServer",["$http",function(e){var t="http://192.168.1.102:8000";return{storeDeviceToken:function(o,r){var n={user:"user"+Math.floor(1e7*Math.random()+1),type:o,token:r};console.log("Post token for registered device with data "+JSON.stringify(n)),e.post(t+"/subscribe",JSON.stringify(n)).success(function(e,t){console.log("Token stored, device is successfully subscribed to receive push notifications.")}).error(function(e,t){console.log("Error storing device token."+e+" "+t)})},removeDeviceToken:function(o){var r={token:o};e.post(t+"/unsubscribe",JSON.stringify(r)).success(function(e,t){console.log("Token removed, device is successfully unsubscribed and will not receive push notifications.")}).error(function(e,t){console.log("Error removing device token."+e+" "+t)})}}}]).factory("AdMob",["$window",function(e){var t=e.AdMob;if(t){document.addEventListener("onAdFailLoad",function(e){console.log("error: "+e.error+", reason: "+e.reason+", adNetwork:"+e.adNetwork+", adType:"+e.adType+", adEvent:"+e.adEvent)}),document.addEventListener("onAdLoaded",function(e){console.log("onAdLoaded: "+e)}),document.addEventListener("onAdPresent",function(e){console.log("onAdPresent: "+e)}),document.addEventListener("onAdLeaveApp",function(e){console.log("onAdLeaveApp: "+e)}),document.addEventListener("onAdDismiss",function(e){console.log("onAdDismiss: "+e)});var o={position:t.AD_POSITION.BOTTOM_CENTER,bgColor:"black",isTesting:!0},r={};ionic.Platform.isAndroid()&&(r={banner:"ca-app-pub-6869992474017983/9375997553",interstitial:"ca-app-pub-6869992474017983/1657046752"}),ionic.Platform.isIOS()&&(r={banner:"ca-app-pub-6869992474017983/4806197152",interstitial:"ca-app-pub-6869992474017983/7563979554"}),t.setOptions(o),t.prepareInterstitial({adId:r.interstitial,autoShow:!1,success:function(){console.log("interstitial prepared")},error:function(){console.log("failed to prepare interstitial")}})}else console.log("No AdMob?");return{showBanner:function(){t&&t.createBanner({adId:r.banner,position:t.AD_POSITION.BOTTOM_CENTER,autoShow:!0,success:function(){console.log("banner created")},error:function(){console.log("failed to create banner")}})},showInterstitial:function(){t&&t.showInterstitial()},removeAds:function(){t&&t.removeBanner()}}}]).factory("resizer",function(){return function(e,t){if(t=t||150,e){if(e.indexOf("youtube.com")>-1)return e;if(-1===e.indexOf("notfound"))return"//util.vzconsole.com/img/"+e.replace("http://","").replace("https://","")+"?h="+t}return null}}).factory("iAd",["$window",function(e){var t=e.iAd;return t?t.prepareInterstitial({autoShow:!1}):console.log("No iAd?"),{showBanner:function(){t&&t.createBanner({position:t.AD_POSITION.BOTTOM_CENTER,autoShow:!0})},showInterstitial:function(){t&&t.showInterstitial()},removeAds:function(){t&&t.removeBanner()}}}]),angular.module("app.config",[]).constant("GCM_SENDER_ID","574597432927");